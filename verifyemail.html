<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Email Verification</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <label class="theme-switch">
      <input type="checkbox" id="theme-toggle" />
      <span class="slider"></span>
    </label>
    <div class="container" id="content">
      <img src="assets/logo.png" alt="RCM Logo" class="logo" />
      <h2 id="title">Verifying your email...</h2>
      <p id="status-message">Please wait while we confirm your account.</p>
    </div>
    <script src="assets/theme.js"></script>
    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const token = urlParams.get('token');
      const type = urlParams.get('type');
      const errorDesc = urlParams.get('error_description');

      const title = document.getElementById('title');
      const message = document.getElementById('status-message');

      if (errorDesc) {
        title.textContent = "Verification Failed";
        message.textContent = `❌ ${errorDesc}`;
      } else if (!token || type !== 'signup') {
        title.textContent = "Invalid Link";
        message.textContent = "❌ Invalid or expired verification link.";
      } else {
        // Delay message to allow Supabase time to process the verification
        setTimeout(() => {
          title.textContent = "Email Verified";
          message.innerHTML = `✅ Your email has been verified successfully!<br>You can now <a href="/login">log in</a>.`;
        }, 3000);
      }
    </script>
  </body>
</html>
